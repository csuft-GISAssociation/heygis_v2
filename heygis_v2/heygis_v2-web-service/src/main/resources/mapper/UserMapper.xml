<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.heygis.mapper.UserMapper">

	<select id="queryUserByAccountAndPassWord" parameterType="users" resultType="users">
		select uid,account from users where account=#{account} and password=#{password}
	</select>

	<select id="checkAccount" parameterType="String" resultType="int">
		select count(*) from users where account=#{account}
	</select>

	<select id="checkNickName" parameterType="String" resultType="int">
		select count(*) from users_info where nickname=#{nickName}
	</select>

	<insert id="insertUsers" parameterType="users" >
		<selectKey resultType="int" order="AFTER" keyProperty="uid">
			SELECT LAST_INSERT_ID()
		</selectKey>
		insert into users(account,password) values(#{account},#{password})
	</insert>

	<insert id="insertUsersInfo" parameterType="users">
		  insert into users_info (uid,account,mail,grade,nickname) values(#{uid},#{account},#{mail},#{grade},#{nickname})
	</insert>

	<select id="queryUserInfoByUid" parameterType="int" resultType="UsersInfo">
		select uid,account,gender,tel,QQ,selfintroduction,icon_img,grade,nickname,name from users_info where uid=#{uid}
	</select>

	<update id="updateUserInfoByUid" parameterType="UsersInfo">
		update users_info set nickname=#{nickname},grade=#{grade},gender=#{gender},selfintroduction=#{selfintroduction},QQ=#{qq},tel=#{tel},name=#{name} where uid=#{uid}
	</update>

	<update id="updateUserIconByUid" parameterType="UsersInfo">
		update users_info set icon_img=#{icon_img} where uid=#{uid}
	</update>

	<select id="queryUserList" resultType="users">
		select account,uid from users
	</select>



</mapper>